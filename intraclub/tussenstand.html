<style type="text/css">
  .table-intraclub {
    width: 100%;
    max-width: 100%;
    margin-bottom: 1rem;
    background-color: transparent;
    border-collapse: collapse;
  }
  .table-intraclub td {
    padding: 0.75rem;
    vertical-align: top;
  }
  .table-intraclub th {
    padding-left: 0.75rem;
    vertical-align: top;
  }
  .table-intraclub tr {
    border-bottom: 1px solid #eb0000;
  }
  .table-intraclub tr:last-child {
    border-bottom: 0px;
  }
  .hover {
    background-color: #ccc !important;
    cursor: pointer;
  }
  ul.tabs {
    margin: 0px;
    padding: 0px;
    list-style: none;
    display: flex;
    align-items: stretch;
    justify-content: space-around;
    flex-wrap: wrap;
    background: #eb0000;
    color: white;
  }
  ul.tabs li {
    background: none;
    display: inline-block;
    padding: 10px 15px;
    cursor: pointer;
  }
  ul.tabs li.current {
    background: white;
    color: black;
    border-top: 1px solid #eb0000;
  }
  .tab-content {
    display: none;
    background: white;
    padding: 15px;
  }
  .tab-content.current {
    display: inherit;
  }
</style>
<h3 class="display-4" style="text-align: center;">Intraclub</h3>
<div id="container">
  <ul class="tabs">
    <li class="tab-link current" data-tab="tab-1">Algemeen</li>
    <li class="tab-link" data-tab="tab-2">Vrouwen</li>
    <li class="tab-link" data-tab="tab-3">Recreanten</li>
    <li class="tab-link" data-tab="tab-4">Veteranen</li>
    <li class="tab-link" data-tab="tab-5">Speeldagen</li>
  </ul>
  <div id="tab-1" class="tab-content current">
    <table class="table-intraclub">
      <thead>
        <tr>
          <th></th>
          <th>Naam</th>
          <th></th>
          <th>Score</th>
        </tr>
      </thead>
    </table>
  </div>
  <div id="tab-2" class="tab-content">
    <table class="table-intraclub">
      <thead>
        <tr>
          <th></th>
          <th>Naam</th>
          <th></th>
          <th>Score</th>
        </tr>
      </thead>
    </table>
  </div>
  <div id="tab-3" class="tab-content">
    <table class="table-intraclub">
      <thead>
        <tr>
          <th></th>
          <th>Naam</th>
          <th></th>
          <th>Score</th>
        </tr>
      </thead>
    </table>
  </div>
  <div id="tab-4" class="tab-content">
    <table class="table-intraclub">
      <thead>
        <tr>
          <th></th>
          <th>Naam</th>
          <th></th>
          <th>Score</th>
        </tr>
      </thead>
    </table>
  </div>
  <div id="tab-5" class="tab-content">
    <table class="table-intraclub">
      <thead>
        <tr>
          <th>#</th>
          <th>Datum</th>
          <th>Spelers</th>
          <th>Gemiddelde afwezigen</th>
        </tr>
      </thead>
    </table>
  </div>
</div>
<script type="text/javascript">
  jQuery.getJSON("/intraclub-api/index.php/rankings", function (data) {
    generateRanking(data.general, data.seasonId, "tab-1");
    generateRanking(data.women, data.seasonId, "tab-2");
    generateRanking(data.recreants, data.seasonId, "tab-3");
    generateRanking(data.veterans, data.seasonId, "tab-4");
  });
  jQuery.getJSON("intraclub-api/index.php/rounds", function (data) {
    trHtml = "";
    jQuery.each(data.reverse(), function (i, item) {
      trHtml +=
        "<tr><td>" +
        item.number +
        "</td><td>" +
        formatDate(item.date) +
        "</td><td>" +
        parseInt(item.matches) * 4 +
        "</td><td>" +
        item.averageAbsent +
        "</td></tr>";
    });
    jQuery("#tab-5 table").append(trHtml);
  });
  function generateRanking(data, seasonId, tabId) {
    trHtml = "";
    jQuery.each(data, function (i, item) {
      trHtml +=
        "<tr><td>" +
        item.rank +
        "</td><td>" +
        item.firstName +
        " " +
        item.name +
        '</td><td style="min-width: 60px;">' +
        formatDifferenceCell(item.difference) +
        "</td><td>" +
        item.average +
        "</td></tr>";
    });
    jQuery("#" + tabId + " table").append(trHtml);
  }

  function formatDifferenceCell(difference) {
    if (difference < 0) {
      return (
        "<i style='margin-right: 5px;color: red;' class='fa fa-caret-down fa-lg'></i>" +
        Math.abs(difference)
      );
    } else if (difference > 0) {
      return (
        "<i style='margin-right: 5px;color: green;' class='fa fa-caret-up fa-lg'></i>" + difference
      );
    }
    return "-";
  }

  function formatDate(date) {
    dateObject = new Date(date);
    return (
      dateObject.getDate() + "/" + (dateObject.getMonth() + 1) + "/" + dateObject.getFullYear()
    );
  }

  jQuery("ul.tabs li").click(function () {
    var tab_id = jQuery(this).attr("data-tab");
    jQuery("ul.tabs li").removeClass("current");
    jQuery(".tab-content").removeClass("current");
    jQuery(this).addClass("current");
    jQuery("#" + tab_id).addClass("current");
  });
  // document.addEventListener(
  //   "click",
  //   function (event) {
  //     // If the clicked element doesn't have the right selector, bail
  //     if (!event.target.matches("ul.tabs li")) return;
  //     debugger;
  //     // Don't follow the link
  //     //event.preventDefault();

  //     // Log the clicked element in the console
  //     console.log(event.target);
  //   },
  //   false
  // );
</script>
